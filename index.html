<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YUMEKO SUSHIS</title>

  <!-- Police Poppins -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand:#8b0000;
      --brand-2:#a31212;
      --text:#f8f8f8;
      --card:#1b1b1b;
      --muted:#cfcfcf;
      --accent:#ffb6b6;
      --accent-2:#ff8c8c;
      --barShade:.35;
    }

    #orderSection { display: none !important; }

    *{ box-sizing: border-box; }
    body{ margin:0; font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background: linear-gradient(180deg, #0f0f0f 0%, #8b0000 100%); color:var(--text); min-height:100vh; }

    .hero{ background:linear-gradient(to bottom,rgba(0,0,0,.55),rgba(0,0,0,.75)),url('images/hero.jpg') center/cover no-repeat; padding:60px 20px; text-align:center; }
    h1.brand{ font-size:2.5rem; margin:10px 0; letter-spacing:2px; font-weight:800; }
    .cta{ background:var(--brand); border:none; color:#fff; padding:14px 18px; border-radius:10px; font-weight:800; cursor:pointer; }
    .cta:hover{ background:var(--brand-2); }

    .container{ max-width:1100px; margin:0 auto; padding:20px; }
    .section{ background:#160c0c; border:1px solid rgba(255,255,255,.08); border-radius:18px; padding:20px; box-shadow:0 10px 30px rgba(0,0,0,.25); margin-bottom:25px;}
    .section-title{ color:#fff; font-size:1.8rem; margin-bottom:10px; }

    .menu-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:14px; }
    .item-card{ background:var(--card); border:1px solid rgba(255,255,255,.06); border-radius:14px; padding:0; display:flex; flex-direction:column; overflow:hidden; cursor:pointer; transition:transform .12s ease, box-shadow .12s ease; }
    .item-card:hover{ transform:translateY(-2px); box-shadow:0 8px 24px rgba(0,0,0,.35); }
    .thumb{ width:100%; aspect-ratio:1/1; object-fit:cover; display:block; background:#0d0d0d; }
    .thumb.sm{ width:40px; height:40px; border-radius:8px; }
    .item-name{ font-weight:700; font-size:.98rem; padding:10px 12px 4px; }

    .card-body{ padding:0 12px 10px; display:flex; flex-direction:column; gap:8px; }
    .card-footer{ margin-top:auto; display:flex; align-items:center; justify-content:space-between; padding:10px 12px 12px; border-top:1px dashed rgba(255,255,255,.08); }
    .meta{ display:flex; flex-direction:column; line-height:1.1; gap:4px; }
    .pieces{ font-size:.9rem; color:var(--muted); }
    .price{ font-size:.95rem; font-weight:800; }

    .ctrls{ display:flex; align-items:center; gap:8px; }
    .circle{ background:var(--accent); border:none; color:#111; width:36px; height:36px; border-radius:50%; font-weight:900; cursor:pointer; }
    .circle:hover{ background:var(--accent-2); }
    .qty-badge{ min-width:22px; text-align:center; font-weight:800; }
    .qty-badge.is-zero{ visibility:hidden; }

    .btn{ background:var(--accent); border:none; color:#111; width:34px; height:34px; border-radius:50%; font-weight:900; cursor:pointer; transition:transform .15s; }
    .btn:hover{ background:var(--accent-2); transform:scale(1.1); }
    .qty{ min-width:22px; text-align:center; font-weight:800; }
    .qty.bump{ transform:scale(1.15); transition:transform .2s; }

    form input, form textarea{ width:90%; max-width:520px; background:#161616; color:#fff; border:1px solid rgba(255,255,255,.2); border-radius:10px; padding:10px; margin:6px auto; display:block; }
    textarea{ resize:vertical; min-height:90px; }
    .muted{ color:#cfcfcf; opacity:.95; font-size:14px; }

    #stickyBar{ position:fixed; bottom:0; left:0; right:0; z-index:100; background: linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,var(--barShade))); padding:10px; }
    #stickyInner{ width:min(96%,1100px); margin:0 auto; display:flex; flex-direction:column; gap:8px; align-items:center; }
    #miniRecap{ display:none !important; font-size:13px; color:#eee; opacity:.95; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    #miniRecap::-webkit-scrollbar{ display:none; }
    #gotoOrder{ width:auto; background:var(--brand); color:#fff; font-weight:900; border:none; border-radius:12px; padding:14px 18px; cursor:pointer; white-space:nowrap; }

    #cartSheet{ position:fixed; left:50%; transform:translateX(-50%); bottom:-100%; width:min(96%,1100px); background:#1b1b1b; color:#fff; border:1px solid rgba(255,255,255,.12); border-radius:16px 16px 0 0; box-shadow:0 22px 60px rgba(0,0,0,.45); max-height:70vh; display:flex; flex-direction:column; transition:bottom .28s ease; z-index:101; }
    #cartSheet.open{ bottom:62px; }
    #cartSheet header, #cartSheet footer{ padding:10px 12px; display:flex; align-items:center; justify-content:space-between; }
    #cartSheet header{ border-bottom:1px solid rgba(255,255,255,.1); }
    #cartSheet footer{ border-top:1px solid rgba(255,255,255,.1); gap:10px; justify-content:flex-end; }
    #cartSheet header h3{ margin:0; font-size:18px; }
    #cartSheet header button{ background:transparent; border:none; color:#fff; font-size:22px; cursor:pointer; }
    #cartSheet .body{ padding:10px; overflow:auto; }
    .recap-list{ list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:8px; }
    .recap-item{ display:flex; align-items:center; justify-content:space-between; gap:10px; padding:8px 6px; border-bottom:1px dashed rgba(255,255,255,.1); }
    .recap-item .it-left{ display:flex; align-items:center; gap:10px; min-width:0; flex:1; }
    .recap-item .it-label{ flex:1; min-width:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .recap-item .it-ctrl{ display:flex; align-items:center; gap:8px; }

    .btn-ghost, .btn-primary{ border:none; border-radius:12px; padding:12px 16px; font-weight:900; cursor:pointer; }
    .btn-ghost{ background:#2a2a2a; color:#fff; }
    .btn-ghost:hover{ filter:brightness(1.1); }
    .btn-primary{ background:var(--brand); color:#fff; }
    .btn-primary:hover{ background:var(--brand-2); }

    footer{ text-align:center; color:#d7d7d7; margin:60px 0 120px; }

    .step{ display:none; }
    .step.active{ display:block; }
    .hr{ border-top:1px solid rgba(255,255,255,.08); margin:10px 0; }

    #recapOptions{ display:none !important; }
    .hero .logo{ width:160px; }
    @media (min-width: 768px){ .hero .logo{ width:200px; } }
  </style>
  <link rel="icon" type="image/png" href="images/favicon.png" />
  <link rel="apple-touch-icon" href="images/favicon.png" />
  <meta name="theme-color" content="#8b0000" />
</head>
<body>

  <section class="hero">
    <img src="images/logo-yumeko.png" alt="YUMEKO SUSHIS" class="logo" style="border-radius:50%;box-shadow:0 0 10px rgba(0,0,0,.3)">
    <h1 class="brand">YUMEKO SUSHIS</h1>
    <p class="muted" style="margin-top:6px;font-size:0.95rem;">Informations complémentaires</p>
    <button class="cta" id="ctaOrder">Commander maintenant</button>
  </section>

  <main class="container">
    <section class="section" id="menuSection">
      <div id="menu"></div>
    </section>

    <!-- MODALE DÉTAIL PRODUIT -->
    <div id="itemModal" class="modal" aria-hidden="true" style="position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:102;">
      <div class="modal-card" role="dialog" aria-modal="true" style="width:min(680px,96vw);background:#1b1b1b;border:1px solid rgba(255,255,255,.12);border-radius:16px;overflow:hidden;box-shadow:0 22px 60px rgba(0,0,0,.5)">
        <div style="position:relative">
          <img id="mImg" src="" alt="" style="width:100%;aspect-ratio:16/9;object-fit:cover;background:#0d0d0d">
          <button id="mClose" aria-label="Fermer" style="position:absolute;top:8px;right:8px;background:rgba(0,0,0,.5);color:#fff;border:none;border-radius:10px;padding:8px 10px;cursor:pointer">✕</button>
        </div>
        <div style="padding:14px 16px;display:flex;flex-direction:column;gap:10px">
          <h3 id="mTitle" style="margin:0;font-size:1.25rem"></h3>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;font-size:.95rem;color:#ddd">
            <div><strong>Pièces :</strong> <span id="mPieces">—</span></div>
            <div><strong>Allergènes :</strong> <span id="mAllergens">Non renseigné</span></div>
          </div>
          <div><strong>Composition :</strong><br><span id="mComp">Non renseigné</span></div>
          <div><strong>Description :</strong><br><span id="mDesc">—</span></div>
          <div style="padding:0 16px 16px;display:flex;align-items:center;justify-content:flex-end;gap:10px">
            <button id="mMinus" class="circle" style="visibility:hidden">−</button>
            <span id="mQty" class="qty-badge">0</span>
            <button id="mPlus" class="circle">+</button>
          </div>
        </div>
      </div>
    </div>

    <!-- FORM COMMANDE (déplacé dans le tiroir) -->
    <section class="section" id="orderSection" style="text-align:center;">
      <h2 class="section-title">Validez votre commande</h2>
      <form id="orderForm" action="https://formspree.io/f/xblzvgjr" method="POST">
        <input name="first_name" placeholder="Prénom" required>
        <input name="last_name" placeholder="Nom" required>
        <input name="phone" type="tel" placeholder="Téléphone" required>

        <p class="muted" style="margin-top:8px">Options :</p>
        <div style="display:flex;flex-wrap:wrap;justify-content:center;gap:12px;margin-bottom:10px;">
          <div>
            <span class="muted">Soja sucrée :</span><br>
            <button type="button" class="btn opt-minus" data-opt="sojaSucree">−</button>
            <span class="qty opt-qty" data-opt="sojaSucree">0</span>
            <button type="button" class="btn opt-plus" data-opt="sojaSucree">+</button>
          </div>
          <div>
            <span class="muted">Soja salée :</span><br>
            <button type="button" class="btn opt-minus" data-opt="sojaSalee">−</button>
            <span class="qty opt-qty" data-opt="sojaSalee">0</span>
            <button type="button" class="btn opt-plus" data-opt="sojaSalee">+</button>
          </div>
          <div>
            <span class="muted">Wasabi :</span><br>
            <button type="button" class="btn opt-minus" data-opt="wasabi">−</button>
            <span class="qty opt-qty" data-opt="wasabi">0</span>
            <button type="button" class="btn opt-plus" data-opt="wasabi">+</button>
          </div>
          <div>
            <span class="muted">Gingembre :</span><br>
            <button type="button" class="btn opt-minus" data-opt="gingembre">−</button>
            <span class="qty opt-qty" data-opt="gingembre">0</span>
            <button type="button" class="btn opt-plus" data-opt="gingembre">+</button>
          </div>
        </div>

        <div style="margin:8px 0 12px">
          <span class="muted" style="display:block;margin-bottom:6px;">Baguettes :</span>
          <button type="button" class="btn" id="bagMinus">−</button>
          <span class="qty" id="bagQty">1</span>
          <button type="button" class="btn" id="bagPlus">+</button>
          <input type="hidden" name="baguettes" id="bagInput" value="1">
        </div>

        <p class="muted" style="margin:8px 0 4px">Date & heure de livraison (facultatif)</p>
        <input type="date" id="deliveryDate" name="delivery_date">
        <input type="time" id="deliveryTime" name="delivery_time" step="900">

        <textarea name="comments" id="comments" placeholder="Commentaire (allergies ou autres)"></textarea>
        <div id="orderResult" style="margin-top:8px;font-size:14px;"></div>
      </form>
    </section>
  </main>

  <div id="stickyBar" aria-live="polite">
    <div id="stickyInner">
      <span id="miniRecap"></span>
      <button id="gotoOrder">Panier (0) • Valider</button>
    </div>
  </div>

  <div id="cartSheet" aria-hidden="true">
    <header>
      <h3>Valider votre commande</h3>
      <button id="sheetClose" aria-label="Fermer">×</button>
    </header>
    <div class="body">
      <div id="stepCart" class="step active">
        <p class="muted" id="sheetIntro">Vérifie ton panier et ajuste les quantités :</p>
        <ul class="recap-list" id="recapList"></ul>
        <div id="recapOptions" style="margin-top:6px;"></div>
        <div id="recapPickup" class="muted" style="margin-top:6px;"></div>
        <div id="recapComment" class="muted" style="margin-top:4px;"></div>
      </div>
      <div id="stepDetails" class="step"></div>
    </div>
    <footer>
      <div id="footerCart" class="step active">
        <button class="btn-primary" id="goDetails">Valider le panier →</button>
      </div>
      <div id="footerDetails" class="step">
        <button class="btn-ghost" id="backToCart">← Retour</button>
        <button class="btn-primary" id="confirmSend">Confirmer et envoyer</button>
      </div>
    </footer>
  </div>

  <footer>© 2025 YUMEKO SUSHIS — Les sushis qui font ronronner vos papilles</footer>

  <script>
  (function(){
    if (typeof window.CSS === 'undefined') window.CSS = {};
    if (typeof window.CSS.escape !== 'function') {
      window.CSS.escape = function(sel){
        return String(sel).replace(/[
