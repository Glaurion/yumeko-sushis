<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YUMEKO SUSHIS</title>
  <style>
    :root{
      --brand:#8b0000; --brand-2:#a31212; --text:#f8f8f8;
      --card:#1b1b1b; --muted:#cfcfcf; --accent:#ffb6b6; --accent-2:#ff8c8c;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0; font-family:'Poppins',sans-serif;
      background:linear-gradient(180deg,#0f0f0f 0%,#8b0000 100%);
      color:var(--text); min-height:100vh;
    }

    /* HERO */
    .hero{
      background:linear-gradient(to bottom,rgba(0,0,0,.55),rgba(0,0,0,.75)),url('images/hero.jpg') center/cover no-repeat;
      padding:60px 20px; text-align:center;
    }
    h1.brand{ font-size:2.5rem; margin:10px 0; letter-spacing:2px; font-weight:800; }
    .cta{ background:var(--brand); border:none; color:#fff; padding:14px 18px; border-radius:10px; font-weight:800; cursor:pointer; }
    .cta:hover{ background:var(--brand-2); }

    /* LAYOUT */
    .container{ max-width:1100px; margin:0 auto; padding:20px; }
    .section{ background:#160c0c; border:1px solid rgba(255,255,255,.08); border-radius:18px; padding:20px; box-shadow:0 10px 30px rgba(0,0,0,.25); margin-bottom:25px;}
    .section-title{ color:#fff; font-size:1.8rem; margin-bottom:10px; }

    /* MENU */
    .menu-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:12px; }
    .item-card{ background:var(--card); border:1px solid rgba(255,255,255,.06); border-radius:14px; padding:12px; display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .left{ display:flex; align-items:center; gap:10px; min-width:0; }
    .thumb{ width:60px; height:60px; border-radius:10px; object-fit:cover; background:#0d0d0d; box-shadow:0 0 8px rgba(0,0,0,.35); }
    .item-name{ font-weight:700; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .controls{ display:flex; align-items:center; gap:8px; }
    .btn{ background:var(--accent); border:none; color:#111; width:34px; height:34px; border-radius:50%; font-weight:900; cursor:pointer; transition:transform .15s; }
    .btn:hover{ background:var(--accent-2); transform:scale(1.1); }
    .qty{ min-width:22px; text-align:center; font-weight:800; }
    .qty.bump{ transform:scale(1.15); transition:transform .2s; }

    /* FORM */
    form input, form textarea{ width:90%; max-width:520px; background:#161616; color:#fff; border:1px solid rgba(255,255,255,.2); border-radius:10px; padding:10px; margin:6px auto; display:block; }
    textarea{ resize:vertical; min-height:90px; }

    /* STICKY BAR */
    #stickyBar{ position:fixed; bottom:0; left:0; right:0; background:linear-gradient(180deg,rgba(0,0,0,0),rgba(0,0,0,.55)); padding:10px; z-index:100; }
    #stickyInner{ width:min(96%,1100px); margin:0 auto; }
    #gotoOrder{ width:100%; background:var(--brand); color:#fff; font-weight:900; border:none; border-radius:12px; padding:14px; cursor:pointer; }

    /* TIROIR R√âCAP */
    #cartSheet{
      position:fixed; left:50%; transform:translateX(-50%); bottom:-100%;
      width:min(96%,1100px); background:#1b1b1b; color:#fff;
      border:1px solid rgba(255,255,255,.12); border-radius:16px 16px 0 0;
      box-shadow:0 22px 60px rgba(0,0,0,.45); max-height:70vh;
      display:flex; flex-direction:column; transition:bottom .28s ease; z-index:101;
    }
    #cartSheet.open{ bottom:62px; }
    #cartSheet header, #cartSheet footer{ padding:10px 12px; display:flex; align-items:center; justify-content:space-between; }
    #cartSheet header{ border-bottom:1px solid rgba(255,255,255,.1); }
    #cartSheet footer{ border-top:1px solid rgba(255,255,255,.1); gap:10px; justify-content:flex-end; }
    #cartSheet header h3{ margin:0; font-size:18px; }
    #cartSheet header button{ background:transparent; border:none; color:#fff; font-size:22px; cursor:pointer; }
    #cartSheet .body{ padding:10px; overflow:auto; }
    .recap-list{ list-style:none; margin:0; padding:0; }
    .recap-list li{ display:flex; justify-content:space-between; padding:8px 6px; border-bottom:1px dashed rgba(255,255,255,.1); }
    .muted{ color:#cfcfcf; opacity:.95; font-size:14px; }
    .btn-ghost{ background:transparent; border:1px solid rgba(255,255,255,.3); color:#fff; padding:10px 14px; border-radius:10px; cursor:pointer; }
    .btn-primary{ background:var(--brand); border:none; color:#fff; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:800; }
    .btn-primary:hover{ background:var(--brand-2); }

    footer{ text-align:center; color:#d7d7d7; margin:60px 0 120px; }
    .shake{ animation:shake .35s; } @keyframes shake{0%,100%{transform:translateX(0);}25%{transform:translateX(-4px);}50%{transform:translateX(4px);}75%{transform:translateX(-2px);}}
  </style>
</head>
<body>

  <!-- HERO -->
  <section class="hero">
    <img src="logo-yumeko.png" alt="logo" width="120" style="border-radius:50%;box-shadow:0 0 10px rgba(0,0,0,.3)">
    <h1 class="brand">üç£ YUMEKO SUSHIS üç£</h1>
    <p>Commandez vos sushis pr√©f√©r√©s simplement ici üç±</p>
    <button class="cta" id="ctaOrder">Commander maintenant</button>
  </section>

  <main class="container">
    <!-- MENU -->
    <section class="section" id="menuSection">
      <h2 class="section-title">Menu</h2>
      <div id="menu"></div>
    </section>

    <!-- FORM COMMANDE -->
    <section class="section" id="orderSection" style="text-align:center;">
      <h2 class="section-title">Validez votre commande</h2>
      <form id="orderForm" action="https://formspree.io/f/xblzvgjr" method="POST">
        <input name="name" placeholder="Votre pr√©nom" required>
        <input name="phone" placeholder="T√©l√©phone (optionnel)">

        <p class="muted" style="margin-top:8px">Options :</p>
        <p>
          <label><input type="checkbox" id="optSojaSucree"> Soja sucr√©e</label>
          <label style="margin-left:12px"><input type="checkbox" id="optSojaSalee"> Soja sal√©e</label>
          <label style="margin-left:12px"><input type="checkbox" id="optWasabi"> Wasabi</label>
          <label style="margin-left:12px"><input type="checkbox" id="optGingembre"> Gingembre</label>
        </p>

        <div style="margin:8px 0 12px">
          <span class="muted" style="display:block;margin-bottom:6px;">Baguettes :</span>
          <button type="button" class="btn" id="bagMinus">‚àí</button>
          <span class="qty" id="bagQty">1</span>
          <button type="button" class="btn" id="bagPlus">+</button>
          <input type="hidden" name="baguettes" id="bagInput" value="1">
        </div>

        <p class="muted" style="margin:8px 0 4px">Date & heure de retrait (facultatif)</p>
        <input type="date" id="pickupDate" name="pickup_date">
        <input type="time" id="pickupTime" name="pickup_time" step="900">

        <textarea name="comments" id="comments" placeholder="Commentaire (allergies, sauce en plus, heure pr√©cise, etc.)"></textarea>
        <textarea name="order" id="orderText" hidden></textarea>

        <button type="submit" class="cta" style="margin-top:10px;">Envoyer ma commande üç£</button>
        <div id="orderResult" style="margin-top:8px;font-size:14px;"></div>
      </form>
    </section>
  </main>

  <!-- BANDEAU PANIER -->
  <div id="stickyBar" aria-live="polite">
    <div id="stickyInner">
      <button id="gotoOrder">Panier (0) ‚Ä¢ Valider</button>
    </div>
  </div>

  <!-- TIROIR R√âCAP -->
  <div id="cartSheet" aria-hidden="true">
    <header>
      <h3>Valider votre commande</h3>
      <button id="sheetClose" aria-label="Fermer">√ó</button>
    </header>
    <div class="body">
      <p class="muted" id="sheetIntro">V√©rifie ton panier avant l‚Äôenvoi :</p>
      <ul class="recap-list" id="recapList"></ul>
      <div id="recapOptions" style="margin-top:6px;"></div>
      <div id="recapPickup" class="muted" style="margin-top:6px;"></div>
      <div id="recapComment" class="muted" style="margin-top:4px;"></div>
    </div>
    <footer>
      <button class="btn-ghost" id="editOrder">Modifier</button>
      <button class="btn-primary" id="confirmSend">Confirmer et envoyer</button>
    </footer>
  </div>

  <footer>¬© 2025 YUMEKO SUSHIS ‚Äî Les sushis qui font ronronner vos papilles</footer>

<script>
/* ===================== Donn√©es ===================== */
const categories = {
  'Maki 4 pi√®ces': ['M1- Saumon','M2- Saumon/Avocat','M3- Saumon/Cheese','M4- Thon','M5- Concombre','M6- Concombre/Cheese','M7- Avocat','M8- Avocat/Cheese'],
  'California 4 pi√®ces': ['C1- Saumon','C2- Saumon/Avocat','C3- Saumon/Cheese','C4- Thon','C5- Concombre','C6- Concombre/Cheese','C7- Avocat','C8- Avocat/Cheese'],
  'Signature 4 pi√®ces': ['S1- California Saumon/Cheese/Oignons frits','S2- Rols Saumon/Avocat/Cheese'],
  'Sashimi 2 pi√®ces': ['Saumon'],
  'Nigiri 2 pi√®ces': ['N1- Saumon','N2- Avocat']
};
// si tu veux des prix, ajoute-les ici: const prices = {'M1':4.00, ...}
const prices = {};

/* ===================== Construction du menu ===================== */
function buildMenu(){
  const menu=document.getElementById('menu');
  for(const [cat,items] of Object.entries(categories)){
    const wrap=document.createElement('div');
    wrap.className='category';
    wrap.innerHTML=`<h3>${cat}</h3><div class="menu-grid"></div>`;
    const grid=wrap.querySelector('.menu-grid');

    items.forEach(item=>{
      const code=item.split('-')[0].trim();
      const name=item.split('-').slice(1).join('-').trim();
      const price=prices[code];

      const card=document.createElement('div');
      card.className='item-card';
      card.innerHTML=`
        <div class="left">
          <img class="thumb" src="images/${code.toLowerCase()}.jpg" alt="${item}" onerror="this.style.display='none'">
          <div class="item-name">${name || item}</div>
        </div>
        <div class="controls">
          ${price!==undefined?`<span class="muted" style="margin-right:6px">${price.toFixed(2)}‚Ç¨</span>`:''}
          <button class="btn minus" data-item="${item}">‚àí</button>
          <span class="qty" data-item="${item}">0</span>
          <button class="btn plus" data-item="${item}">+</button>
        </div>`;
      grid.appendChild(card);
    });

    menu.appendChild(wrap);
  }
}
buildMenu();

/* ===================== Utilitaires ===================== */
function bump(el){ el.classList.add('bump'); setTimeout(()=>el.classList.remove('bump'),200); }
function getTotal(){ let t=0; document.querySelectorAll('.qty[data-item]').forEach(q=>t+=parseInt(q.textContent)||0); return t; }
function updateSticky(){ document.getElementById('gotoOrder').textContent = `Panier (${getTotal()}) ‚Ä¢ Valider`; }

/* +/- sur les cartes (d√©l√©gation) */
document.addEventListener('click', e=>{
  if(e.target.classList.contains('plus') || e.target.classList.contains('minus')){
    const inc = e.target.classList.contains('plus') ? 1 : -1;
    const item = e.target.dataset.item;
    const span = document.querySelector(`.qty[data-item="${item}"]`);
    const v = Math.max(0, (parseInt(span.textContent)||0) + inc);
    span.textContent = v; bump(span); updateSticky();
  }
});

/* Baguettes */
const bagMinus = document.getElementById('bagMinus');
const bagPlus  = document.getElementById('bagPlus');
const bagQty   = document.getElementById('bagQty');
const bagInput = document.getElementById('bagInput');
bagMinus.onclick = ()=>{ const v=Math.max(0,(parseInt(bagQty.textContent)||0)-1); bagQty.textContent=v; bagInput.value=v; bump(bagQty); };
bagPlus.onclick  = ()=>{ const v=(parseInt(bagQty.textContent)||0)+1; bagQty.textContent=v; bagInput.value=v; bump(bagQty); };

/* ===================== Tiroir r√©cap ===================== */
const sheet = document.getElementById('cartSheet');
const gotoOrder = document.getElementById('gotoOrder');
const sheetClose = document.getElementById('sheetClose');

function collectItems(){
  const lines=[];
  document.querySelectorAll('.qty[data-item]').forEach(span=>{
    const q=parseInt(span.textContent)||0;
    if(q>0) lines.push({label:span.dataset.item, qty:q});
  });
  return lines;
}
function collectOptions(){
  const opts=[];
  if(document.getElementById('optSojaSucree').checked) opts.push('Soja sucr√©e');
  if(document.getElementById('optSojaSalee').checked)  opts.push('Soja sal√©e');
  if(document.getElementById('optWasabi').checked)     opts.push('Wasabi');
  if(document.getElementById('optGingembre').checked)  opts.push('Gingembre');
  const bag=parseInt(bagQty.textContent)||0;
  return {opts, bag};
}
function buildRecap(){
  const list = document.getElementById('recapList'); list.innerHTML='';
  const items = collectItems();
  if(items.length===0){
    list.innerHTML = '<li class="muted">Ton panier est vide.</li>';
  }else{
    items.forEach(it=>{
      const li=document.createElement('li');
      li.innerHTML = `<span>${it.label}</span><strong>x${it.qty}</strong>`;
      list.appendChild(li);
    });
  }
  const {opts, bag} = collectOptions();
  const parts=[];
  if(opts.length) parts.push(`Options: ${opts.join(', ')}`);
  if(bag>0) parts.push(`Baguettes x${bag}`);
  document.getElementById('recapOptions').innerHTML = parts.length ? `<p class="muted">${parts.join(' ‚Ä¢ ')}</p>` : '';

  const d=document.getElementById('pickupDate').value;
  const t=document.getElementById('pickupTime').value;
  document.getElementById('recapPickup').textContent = (d||t) ? `Retrait: ${d} ${t}` : '';
  const c=(document.getElementById('comments').value||'').trim();
  document.getElementById('recapComment').textContent = c ? `Commentaire: ${c}` : '';
}

gotoOrder.onclick = ()=>{
  if(getTotal()===0){ gotoOrder.classList.add('shake'); setTimeout(()=>gotoOrder.classList.remove('shake'),400); return; }
  buildRecap();
  sheet.classList.toggle('open');
};
sheetClose.onclick = ()=> sheet.classList.remove('open');
document.getElementById('editOrder').onclick = ()=> sheet.classList.remove('open');

/* ===================== Envoi Formspree ===================== */
function prepareOrderText(){
  const items = collectItems();
  if(!items.length) return false;
  const lines = items.map(it=>`${it.label} x${it.qty}`);
  const {opts, bag} = collectOptions();
  if(opts.length) lines.push(`Options: ${opts.join(', ')}`);
  if(bag>0) lines.push(`Baguettes x${bag}`);
  const d=document.getElementById('pickupDate').value;
  const t=document.getElementById('pickupTime').value;
  const c=(document.getElementById('comments').value||'').trim();
  if(d||t) lines.push(`Retrait: ${d} ${t}`);
  if(c) lines.push(`Commentaire: ${c}`);
  document.getElementById('orderText').value = lines.join('\n');
  return true;
}

document.getElementById('confirmSend').onclick = ()=>{
  if(prepareOrderText()){
    sheet.classList.remove('open');
    const f=document.getElementById('orderForm');
    if(f.requestSubmit) f.requestSubmit(); else f.submit();
  }
};

document.getElementById('orderForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  if(!document.getElementById('orderText').value){
    if(!prepareOrderText()) {
      const r=document.getElementById('orderResult');
      r.textContent="Ajoute au moins un article avant d'envoyer üòä";
      r.style.color="#ffd4d4"; return;
    }
  }
  const form=e.target;
  try{
    const resp=await fetch(form.action,{method:'POST',headers:{'Accept':'application/json'},body:new FormData(form)});
    const r=document.getElementById('orderResult');
    if(resp.ok){
      r.textContent="Merci ! Ta commande a bien √©t√© envoy√©e üç£";
      r.style.color="#b7ffb7";
      document.querySelectorAll('.qty').forEach(s=>s.textContent='0');
      form.reset(); bagQty.textContent='1'; bagInput.value='1'; updateSticky();
    }else{
      r.textContent="Oups, l'envoi a √©chou√©. R√©essaie üôè"; r.style.color="#ffd4d4";
    }
  }catch{
    const r=document.getElementById('orderResult');
    r.textContent="Erreur r√©seau. R√©essaie."; r.style.color="#ffd4d4";
  }
});

/* ===================== Scroll + Init ===================== */
document.getElementById('ctaOrder').onclick = ()=> document.getElementById('menuSection').scrollIntoView({behavior:'smooth'});
updateSticky();
</script>
</body>
</html>
